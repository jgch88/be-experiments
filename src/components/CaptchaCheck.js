import React, { Component } from 'react';
import ReCAPTCHA from 'react-google-recaptcha';

export default class CaptchaCheck extends Component {

  constructor(props) {
    super(props);
    this.state = {
      captchaPassed: false,
    }
  }

  handleChange(value) {
    // use the value generated by the challenge
    // and send it to the v2 api, to get a response to verify that challenge is real
    // then change text on submit button (or show/hide it)
    console.log("Captcha value: ", value);
    this.setState({
      captchaPassed: value,
    });
  }

  render() {
    return (
      <div class="container">
        <h1 class="title">
          Before we begin
        </h1>
        <p class="subtitle">
          Creating an online experiment is hard. We need to make sure that you aren't a bot, and aren't spamming our results.
        </p>
        <p class="subtitle">
          So, we'll need you to fill in a captcha before every experiment! Sorry!
        </p>
        <form id="captcha-form" action="/captchapost" method="POST">
          <ReCAPTCHA
            sitekey="6LeHSX4UAAAAAHEOsFwj78T0mv9CnfIb1tjShAhN"
            onChange={this.handleChange.bind(this)}
          />
          {this.state.captchaPassed && 
          <button class="g-recaptcha button is-primary"
            data-sitekey="6LfeHxUAAAAAAKUx5r05nfKMtc9-syDTdFLftnm"
            data-callback="onSubmit"
          >
            Submit
          </button>
          }
        </form>
      </div>
    )
  }
}

